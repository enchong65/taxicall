<!DOCTYPE html>
<html>
<head>
  <title>計程車叫車表單</title>
  <script src="https://static.line-scdn.net/liff/edge/2/liff.js" onerror="tryFallbackLiffScript()"></script>
  <script id="liff-fallback"></script>
  <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
  <script>eruda.init();</script>
  <style>
    /* 表單樣式 */
    body { font-family: 'Arial', sans-serif; margin: 0; padding: 20px; background-color: #F5F5F5; color: #212121; }
    h1 { font-size: 56px; color: #212121; text-align: center; margin-bottom: 40px; background-color: #FFC107; padding: 20px; border-radius: 10px; }
    .form-group { margin-bottom: 40px; width: 100%; max-width: 100%; }
    label { display: block; font-size: 44px; font-weight: bold; margin-bottom: 15px; color: #212121; }
    input, textarea { padding: 20px; font-size: 40px; width: 100%; box-sizing: border-box; border: 2px solid #212121; border-radius: 10px; }
    button { padding: 25px; font-size: 44px; width: 50%; background-color: #212121; color: #FFC107; border: none; border-radius: 10px; cursor: pointer; display: block; margin: 40px auto; }
    button:hover { background-color: #333333; }
    .error { color: #D32F2F; font-size: 32px; text-align: center; margin-top: 20px; display: none; }
    .debug-log { color: #555555; font-size: 24px; text-align: center; margin-top: 20px; padding: 10px; background-color: #FFFFFF; border: 1px solid #212121; border-radius: 5px; display: block; }
  </style>
</head>
<body>
  <h1 id="formTitle">即時叫車表單</h1>
  <form id="customForm">
    <input type="hidden" id="userId" name="userId" value="">
    <div class="form-group">
      <label for="date">日期</label>
      <input type="date" id="date" name="date" required>
    </div>
    <div class="form-group">
      <label for="time">時間</label>
      <input type="time" id="time" name="time" required>
    </div>
    <div class="form-group">
      <label for="location">地點</label>
      <input type="text" id="location" name="location" required>
    </div>
    <div class="form-group">
      <label for="numberOfPeople">人數</label>
      <input type="number" id="numberOfPeople" name="numberOfPeople" min="1" required>
    </div>
    <div class="form-group">
      <label for="phone">電話</label>
      <input type="tel" id="phone" name="phone" pattern="[0-9]{9,10}" required>
    </div>
    <div class="form-group">
      <label for="notes">備註</label>
      <textarea id="notes" name="notes"></textarea>
    </div>
    <button type="submit">提交</button>
    <p id="error" class="error"></p>
    <p id="debugLog" class="debug-log">頁面載入中...</p>
  </form>

  <script>
    const API_URL = 'http://localhost:3000'; // 後端伺服器的 API URL

    document.getElementById('customForm').addEventListener('submit', (e) => {
      e.preventDefault();

      const formData = new FormData(e.target);

      fetch(`${API_URL}/submit`, {
        method: 'POST',
        body: JSON.stringify(Object.fromEntries(formData)),
        headers: {
          'Content-Type': 'application/json',
        },
      })
        .then(response => {
          if (!response.ok) throw new Error('伺服器回應錯誤: ' + response.statusText);
          return response.json();
        })
        .then(result => {
          alert(result.message);
        })
        .catch(err => {
          console.error('提交失敗:', err.message);
        });
    });
  </script>
</body>
</html>